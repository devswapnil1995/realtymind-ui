
    <ui-error [message]="error()"></ui-error>

    <h2>Admin Analytics</h2>

    <!-- KPI CARDS -->
    @if (loadingKpis()) {
    <div class="kpis">
      <ui-skeleton [height]="100"></ui-skeleton>
      <ui-skeleton [height]="100"></ui-skeleton>
      <ui-skeleton [height]="100"></ui-skeleton>
      <ui-skeleton [height]="100"></ui-skeleton>
    </div>
    } @else if (kpis()) {
    <div class="kpis">
      <div class="kpi">
        <h3>{{ kpis()?.monthlyActiveUsers }}</h3>
        <p>MAU</p>
      </div>

      <div class="kpi">
        <h3>{{ kpis()?.paidUsers }}</h3>
        <p>Paid Users</p>
      </div>

      <div class="kpi">
        <h3>â‚¹{{ kpis()?.monthlyRevenue }}</h3>
        <p>Revenue</p>
      </div>

      <div class="kpi">
        <h3>{{ kpis()?.monthlyChurnRate }}%</h3>
        <p>Churn</p>
      </div>
    </div>
    }

    <!-- FEATURE ADOPTION -->
    <h3>Feature Adoption</h3>
    @if (loadingFeatures()) {
    <ui-skeleton [height]="150"></ui-skeleton>
    } @else if (features() && features().length > 0) {
    <table>
      <tr>
        <th>Feature</th>
        <th>Total Requests</th>
        <th>Paid Usage %</th>
      </tr>
      <tr *ngFor="let f of features()">
        <td>{{ f.feature }}</td>
        <td>{{ f.totalRequests }}</td>
        <td>{{ f.paidUsagePercentage }}%</td>
      </tr>
    </table>
    } @else {
    <p class="no-data">No feature adoption data available</p>
    }

    <!-- PLAN USAGE -->
    <h3>Usage by Plan</h3>
    @if (loadingPlans()) {
    <ui-skeleton [height]="150"></ui-skeleton>
    } @else if (plans() && plans().length > 0) {
    <table>
      <tr>
        <th>Plan</th>
        <th>Total Requests</th>
      </tr>
      <tr *ngFor="let p of plans()">
        <td>{{ p.plan }}</td>
        <td>{{ p.totalRequests }}</td>
      </tr>
    </table>
    } @else {
    <p class="no-data">No plan usage data available</p>
    }

    <!-- TOP USERS -->
    <h3>Top Users</h3>
    @if (loadingUsers()) {
    <ui-skeleton [height]="150"></ui-skeleton>
    } @else if (users() && users().length > 0) {
    <table>
      <tr>
        <th>Email</th>
        <th>Total Requests</th>
      </tr>
      <tr *ngFor="let u of users()">
        <td>{{ u.email }}</td>
        <td>{{ u.totalRequests }}</td>
      </tr>
    </table>
    } @else {
    <p class="no-data">No user data available</p>
    }